<ion-view class="bubble-background">

    <ion-nav-buttons side="left">
      <button class="button button-icon button-clear" ng-click="vm.cancel()">
        <i class="open-icon icon-cancel"></i>
      </button>     
    </ion-nav-buttons>
    <ion-nav-title>
      {{ vm.title }}
    </ion-nav-title>
    <ion-nav-buttons side="right">
      <button class="button button-icon button-clear" ng-show="vm.isFormValid()" ng-click="vm.save()">
        <i class="open-icon icon-validate"></i>
      </button>      
    </ion-nav-buttons>
        
    <ion-content class="new-view" padding="false" scroll="true" has-bouncing="false">
      <div class="avatar-logo" ng-click="vm.getPicture()">
          <img ng-if="vm.newFriend.picture" class="friend-picture" ng-src="data:image/jpeg;base64,{{vm.newFriend.picture}}">
          <i ng-if="!vm.newFriend.picture" class="open-icon icon-avatar"></i>
          <h4>EDIT</h4>        
      </div>
      <form novalidate name="vm.newForm">
        <div class="form-control">
          <i class="open-icon icon-name" ng-class="!vm.newFriend.name ? 'untouched' : ''"></i>
          <input
           type="text" 
           name="username" 
           id="username" 
           placeholder="Name"
           required
           ng-model="vm.newFriend.name">            
        </div>
        <address-input ng-model="vm.newFriend.location" user-location="vm.newFriend.location"></address-input>    
        <div class="form-control code-list" ng-repeat="code in vm.newFriend.codes track by $index">
          <i class="open-icon icon-code" ng-class="!code.label ? 'untouched' : ''"></i>
          <input 
           type="text" 
           name="code" 
           id="code" 
           placeholder="Code"
           required
           ng-model="code.label">
          <button type="button ng-cloak" ng-show="code.label && !$last" ng-click="vm.removeCode($index)">
            <i class="open-icon icon-minus"></i>
          </button>          
          <button type="button ng-cloak" ng-show="code.label && $last" ng-click="vm.addCode()">
            <i class="open-icon icon-plus" ng-show="code"></i>
          </button>          
        </div>
        <div class="form-control">
          <i class="open-icon icon-notes" ng-class="!vm.newFriend.notes ? 'untouched' : ''"></i>
          <textarea 
          name="moreinfo" 
          id="moreinfo" 
          rows="2" 
          placeholder="Note anything you need to remember: floor, stairs.."
          ng-model="vm.newFriend.notes"></textarea>            
        </div>
      </form>    
    </ion-content>
</ion-view>
